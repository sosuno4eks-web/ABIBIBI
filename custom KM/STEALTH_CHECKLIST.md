# –ß–µ–∫–ª–∏—Å—Ç —Å—Ç–µ–ª—Å-–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π KDMapper

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞
- [x] –ó–∞–º–µ–Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ "kdmapper" ‚Üí "rtkaudio" / "Realtek Audio Driver"
- [x] –ó–∞–º–µ–Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ "iqvw64e" ‚Üí "rtkaudio_fix"
- [x] –ó–∞–º–µ–Ω–∞ "intel_cpu_unknown" ‚Üí —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –∏–º–µ–Ω–∞
- [x] –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ DriverEntry
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ usage —Å–æ–æ–±—â–µ–Ω–∏–π

### –£—Ä–æ–≤–µ–Ω—å 2: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞
- [x] –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è Device Name (7 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
  - RtkAudioService
  - RealtekHDAudio
  - IntelAudioHD
  - ConexantAudio
  - VIAAudioService
  - AudioEnhancement
  - HDMIAudioService

- [x] –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏ –¥—Ä–∞–π–≤–µ—Ä–∞
  - –ü—Ä–µ—Ñ–∏–∫—Å—ã: Rtk, Realtek, Intel, Conexant, VIA
  - –°—É—Ñ—Ñ–∏–∫—Å—ã: Audio, HDAudio, AudioHD, Sound, AC97
  - –í–µ—Ä—Å–∏–∏: 64, x64, HD, v2, v3

- [x] –ó–∞—Ç–∏—Ä–∫–∞ PE-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤ –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞—Ç–∏—Ä–∞–Ω–∏–µ –ø–æ—Å–ª–µ –º–∞–ø–ø–∏–Ω–≥–∞
  - –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ñ–ª–∞–≥–æ–º --copy-header

### –£—Ä–æ–≤–µ–Ω—å 3: –ó–∞—â–∏—Ç–∞ –æ—Ç –∞–Ω–∞–ª–∏–∑–∞
- [x] Anti-Debug —Ç–µ—Ö–Ω–∏–∫–∏
  - IsDebuggerPresent
  - CheckRemoteDebuggerPresent
  - NtQueryInformationProcess (DebugPort)
  - CPUID hypervisor detection
  - Sandboxie detection
  - Timing checks

- [x] –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
  - 100-600ms —Ä–∞–Ω–¥–æ–º–Ω—ã–µ –ø–∞—É–∑—ã
  - –£—Å–ª–æ–∂–Ω–µ–Ω–∏–µ timing analysis

- [x] –û–±—Ñ—É—Å–∫–∞—Ü–∏—è —Å—Ç—Ä–æ–∫
  - XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
  - –ú–∞–∫—Ä–æ—Å—ã OBF_STR / OBF_WSTR
  - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω

## ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏:
- [ ] –ü–∞—Ç—á–∏–Ω–≥ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞ (Device Name "Nal" ‚Üí "Rtk")
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `patch_driver_resource.py`
  - –ò–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π —É—è–∑–≤–∏–º—ã–π –¥—Ä–∞–π–≤–µ—Ä

- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏–µ IOCTL –∫–æ–¥–æ–≤
  - –¢–µ–∫—É—â–∏–π: 0x80862007
  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–ª—É—á–∞–π–Ω—ã–π

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏:
- [ ] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
  - kdmapper.vcxproj ‚Üí rtkaudio.vcxproj
  - –ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

- [ ] Code obfuscation
  - LLVM-Obfuscator
  - VMProtect
  - Themida

- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ —É—è–∑–≤–∏–º–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞
  - –°–ø–∏—Å–æ–∫: https://www.loldrivers.io/

## üéØ –£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã

### –ó–∞—â–∏—Ç–∞ –æ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞: 85%
- ‚úÖ –°—Ç—Ä–æ–∫–∏ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ò–º–µ–Ω–∞ —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ PE-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞—Ç–∏—Ä–∞—é—Ç—Å—è
- ‚ö†Ô∏è –ë–∏–Ω–∞—Ä–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
- ‚ö†Ô∏è IOCTL –∫–æ–¥—ã –Ω–µ–∏–∑–º–µ–Ω–Ω—ã

### –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞: 90%
- ‚úÖ Anti-debug –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚úÖ –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
- ‚úÖ Sandbox detection
- ‚úÖ VM detection
- ‚úÖ Timing checks

### –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞: 80%
- ‚úÖ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –∏–º–µ–Ω–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤
- ‚úÖ –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ Device Names
- ‚úÖ –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è
- ‚ö†Ô∏è –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚ö†Ô∏è –°–∏–≥–Ω–∞—Ç—É—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π –æ—Å—Ç–∞—é—Ç—Å—è

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–º

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û—Ä–∏–≥–∏–Ω–∞–ª | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π |
|----------|----------|------------------|
| –°—Ç—Ä–æ–∫–∏ | –Ø–≤–Ω—ã–µ | –û–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ |
| Device Name | –°—Ç–∞—Ç–∏—á–Ω—ã–π (Nal) | –†–∞–Ω–¥–æ–º–Ω—ã–π (7 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤) |
| –ò–º—è –¥—Ä–∞–π–≤–µ—Ä–∞ | –°–ª—É—á–∞–π–Ω–æ–µ | –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Ä–∞–Ω–¥–æ–º–Ω–æ–µ |
| PE Headers | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | –ó–∞—Ç–∏—Ä–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| Anti-Debug | –ù–µ—Ç | 6 –ø—Ä–æ–≤–µ—Ä–æ–∫ |
| –ó–∞–¥–µ—Ä–∂–∫–∏ | –ù–µ—Ç | –°–ª—É—á–∞–π–Ω—ã–µ 100-600ms |
| VM Detection | –ù–µ—Ç | CPUID + Timing |

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞:
```cmd
kdmapper.exe --copy-header --free YourDriver.sys
```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∑–∞—â–∏—Ç–∞:
```cmd
kdmapper.exe --copy-header --free --indPages YourDriver.sys
```

### –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞:
```cmd
kdmapper.exe --copy-header --free --indPages --PassAllocationPtr YourDriver.sys
```

## üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
1. ‚úÖ –¢–µ—Å—Ç –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å —Å–Ω–∏–º–æ–∫ —Å–∏—Å—Ç–µ–º—ã
3. ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å Secure Boot
4. ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å Driver Signature Enforcement
5. ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å Vulnerable Driver Blocklist

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ—Ç–µ–∫—Ç–∞:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –æ—Ç–ª–∞–¥—á–∏–∫–æ–º ‚Üí –¥–æ–ª–∂–µ–Ω –≤—ã–π—Ç–∏
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ Sandboxie ‚Üí –¥–æ–ª–∂–µ–Ω –≤—ã–π—Ç–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Process Monitor –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å strings –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä

## üìà –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
1. –ü–∞—Ç—á–∏–Ω–≥ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞
2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ IOCTL –∫–æ–¥–æ–≤
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ —É—è–∑–≤–∏–º–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
1. Polymorphic code generation
2. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–π –¥—Ä–∞–π–≤–µ—Ä–∞
3. Kernel-mode rootkit –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
1. Code signing —Å –≤–∞–ª–∏–¥–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º
2. HWID spoofer –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
3. Network traffic obfuscation

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repo>

# 2. –û—Ç–∫—Ä—ã—Ç—å –≤ Visual Studio
start kdmapper.sln

# 3. –í—ã–±—Ä–∞—Ç—å Release x64
# 4. Build Solution (Ctrl+Shift+B)

# 5. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
ren x64\Release\kdmapper.exe rtkaudio.exe

# 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
rtkaudio.exe --copy-header --free HelloWorld.sys
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å:
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–∏–≤ –∞–Ω—Ç–∏—á–∏—Ç–æ–≤ –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–∏—Å–∫–æ–≤
- ‚ùå –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

### –ß—Ç–æ –¥–µ–ª–∞—Ç—å:
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ VM
- ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å –±—ç–∫–∞–ø—ã
- ‚úÖ –ü–æ–Ω–∏–º–∞—Ç—å —Ä–∏—Å–∫–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

## üìù –ó–∞–º–µ—Ç–∫–∏

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
1. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
2. Device Name –≤ –¥—Ä–∞–π–≤–µ—Ä–µ –æ—Å—Ç–∞–µ—Ç—Å—è "Nal"
3. IOCTL –∫–æ–¥—ã –Ω–µ–∏–∑–º–µ–Ω–Ω—ã
4. –°–∏–≥–Ω–∞—Ç—É—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π –º–æ–≥—É—Ç –±—ã—Ç—å –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã

### –û–±—Ö–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π:
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `patch_driver_resource.py`
2. –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π —É—è–∑–≤–∏–º—ã–π –¥—Ä–∞–π–≤–µ—Ä
3. –ò–∑–º–µ–Ω–∏—Ç—å IOCTL –∫–æ–¥—ã –≤ –∫–æ–¥–µ
4. –î–æ–±–∞–≤–∏—Ç—å code obfuscation

## üéì –û–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —á—Ç–µ–Ω–∏–µ:
- Windows Kernel Programming
- Rootkit Arsenal
- Practical Reverse Engineering
- Anti-Debug tricks

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:
- https://www.loldrivers.io/ - –ë–∞–∑–∞ —É—è–∑–≤–∏–º—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤
- https://github.com/topics/kernel-driver - –ü—Ä–∏–º–µ—Ä—ã –¥—Ä–∞–π–≤–µ—Ä–æ–≤
- https://www.unknowncheats.me/ - –§–æ—Ä—É–º –ø–æ game hacking

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ACE_BYPASS_MODIFICATIONS.md
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ BUILD_INSTRUCTIONS.md
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ README.MD

---

**–î–∏—Å–∫–ª–µ–π–º–µ—Ä:** –≠—Ç–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫.
