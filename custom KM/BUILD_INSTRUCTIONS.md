# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ KDMapper

## –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ:

‚úÖ –í—Å–µ —Å—Ç—Ä–æ–∫–∏ "kdmapper" –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ "Realtek Audio Driver" / "rtkaudio"
‚úÖ –í—Å–µ —Å—Ç—Ä–æ–∫–∏ "iqvw64e" –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ "rtkaudio_fix"
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞—Ç–∏—Ä–∫–∏ PE-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –ø–æ—Å–ª–µ –º–∞–ø–ø–∏–Ω–≥–∞
‚úÖ –ò–∑–º–µ–Ω–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã DriverEntry –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö
‚úÖ –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è Device Name (7 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
‚úÖ –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏)
‚úÖ Anti-debug –∑–∞—â–∏—Ç–∞ (6 –ø—Ä–æ–≤–µ—Ä–æ–∫)
‚úÖ –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è —É—Å–ª–æ–∂–Ω–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞
‚úÖ –û–±—Ñ—É—Å–∫–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ (XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)

## –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

### üé≤ –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è
- Device Name –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ –∏–∑ 7 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- –ò–º—è –¥—Ä–∞–π–≤–µ—Ä–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ 100-600ms

### üõ°Ô∏è –ó–∞—â–∏—Ç–∞
- –î–µ—Ç–µ–∫—Ç –æ—Ç–ª–∞–¥—á–∏–∫–∞ (IsDebuggerPresent, Remote, DebugPort)
- –î–µ—Ç–µ–∫—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω (CPUID hypervisor bit)
- –î–µ—Ç–µ–∫—Ç Sandboxie
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–∫–æ—Ä–µ–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (sandbox)

### üîí –û–±—Ñ—É—Å–∫–∞—Ü–∏—è
- XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω
- –ó–∞—Ç–∏—Ä–∫–∞ PE-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤ –ø–∞–º—è—Ç–∏ —è–¥—Ä–∞

## –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞:

### 1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- Visual Studio 2019/2022
- Windows SDK
- Windows WDK

### 2. –®–∞–≥–∏ —Å–±–æ—Ä–∫–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `kdmapper.sln` –≤ Visual Studio
2. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `Release` –∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É `x64`
3. –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç (Build -> Build Solution)
4. –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç –≤ –ø–∞–ø–∫–µ `x64/Release/kdmapper.exe`

### 3. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

–î–ª—è –ø–æ–ª–Ω–æ–π –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ:
- `kdmapper.exe` ‚Üí `rtkaudio.exe`
- –ò–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∏–º—è, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –∞—É–¥–∏–æ/—Å–µ—Ç–µ–≤—ã–º–∏ –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```cmd
kdmapper.exe --copy-header --free YourDriver.sys
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `--copy-header` - –í–∫–ª—é—á–∞–µ—Ç –∑–∞—Ç–∏—Ä–∫—É PE-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–ª—è –æ–±—Ö–æ–¥–∞ ACE)
- `--free` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `--indPages` - –ú–∞–ø–ø–∏–Ω–≥ –≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–∞–º—è—Ç–∏
- `--PassAllocationPtr` - –ü–µ—Ä–µ–¥–∞–µ—Ç –∞–¥—Ä–µ—Å –∞–ª–ª–æ–∫–∞—Ü–∏–∏ –∫–∞–∫ –ø–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä

### –ü—Ä–∏–º–µ—Ä —Å –≤–∞—à–∏–º –¥—Ä–∞–π–≤–µ—Ä–æ–º:
```cmd
kdmapper.exe --copy-header --free --indPages HelloWorld.sys
```

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

### ‚ö†Ô∏è –£—è–∑–≤–∏–º—ã–π –¥—Ä–∞–π–≤–µ—Ä:
–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä `iqvw64e.sys` –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –∏–∑–º–µ–Ω–µ–Ω—ã –Ω–∞ `rtkaudio_fix.sys`. 

–î–ª—è –ø–æ–ª–Ω–æ–π –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ –Ω—É–∂–Ω–æ:
1. –ò–∑–≤–ª–µ—á—å –¥—Ä–∞–π–≤–µ—Ä –∏–∑ —Ä–µ—Å—É—Ä—Å–æ–≤
2. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –µ–≥–æ
3. –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞

### ‚ö†Ô∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
1. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –¢–û–õ–¨–ö–û –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
2. –°–æ–∑–¥–∞–π—Ç–µ —Å–Ω–∏–º–æ–∫ —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. –û—Ç–∫–ª—é—á–∏—Ç–µ Secure Boot –≤ BIOS
4. –û—Ç–∫–ª—é—á–∏—Ç–µ Driver Signature Enforcement

### ‚ö†Ô∏è Vulnerable Driver Blocklist:
–ï—Å–ª–∏ –¥—Ä–∞–π–≤–µ—Ä –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω —Å–∏—Å—Ç–µ–º–æ–π:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `regedit.exe`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CI\Config`
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `VulnerableDriverBlocklistEnable` = `0` (DWORD)
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–º–ø—å—é—Ç–µ—Ä

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ–¥–µ –Ω–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π:
- ‚ùå "kdmapper"
- ‚ùå "iqvw64e"
- ‚ùå "intel_cpu_unknown"

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
- ‚úÖ "Realtek Audio Driver"
- ‚úÖ "rtkaudio"
- ‚úÖ "rtkaudio_fix"

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞:

–î–ª—è –µ—â–µ –±–æ–ª—å—à–µ–π –∑–∞—â–∏—Ç—ã –æ—Ç –¥–µ—Ç–µ–∫—Ç–∞:
1. –ò–∑–º–µ–Ω–∏—Ç–µ Device Name –≤ `intel_driver.cpp` (\\Device\\Nal ‚Üí \\Device\\RtkAudio)
2. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ñ—É—Å–∫–∞—Ü–∏—é —Å—Ç—Ä–æ–∫
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π —É—è–∑–≤–∏–º—ã–π –¥—Ä–∞–π–≤–µ—Ä
4. –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä—É–π—Ç–µ –∏–º–µ–Ω–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

## –û—Ç–ª–∞–¥–∫–∞:

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –æ—à–∏–±–∫–∏:
- `0xC0000022` / `0xC000009A` - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–Ω—Ç–∏—á–∏—Ç–æ–º/–∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–º
- `0xC0000603` - –î—Ä–∞–π–≤–µ—Ä –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ (—Å–º. –≤—ã—à–µ)
- `Device\\Nal is already in use` - –î—Ä–∞–π–≤–µ—Ä —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–ª–∏ –Ω–µ –≤—ã–≥—Ä—É–∂–µ–Ω

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞:

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–º.:
- `ACE_BYPASS_MODIFICATIONS.md` - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `README.MD` - –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è KDMapper
